<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FATE Aracı</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Encode+Sans+SC:wght@500;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="style.css">
</head>
<body data-theme="dark">

    <aside id="burger-menu" class="burger-menu">
        <h1 class="menu-title">FATE Aracı</h1>
        
        <nav class="main-nav">
            <button class="nav-button active" data-view="char">Karakter Sayfası</button>
            <button class="nav-button" data-view="roller">Zar Atıcı</button>
            <button class="nav-button" data-view="find-campaign">Kampanya Ara</button>
            <button class="nav-button" data-view="campaign">Kampanya Paneli (GM)</button>
        </nav>
        
        <div class="menu-divider"></div>
        <h2 class="menu-subtitle">Araçlar</h2>
        <nav class="main-nav">
            <button class="nav-button" data-view="import-export">İçe / Dışa Aktar</button>
        </nav>
        
        <nav class="main-nav" style="display: none;">
             <button class="nav-button" data-view="gm-admin">GM Yönetim</button>
        </nav>

        <footer class="menu-footer">
            <div class="menu-links">
                <a href="https://discord.gg/2cxXsrVw" id="discord-link" class="social-link" title="Discord Sunucusu" target="_blank">
                    <svg viewBox="0 0 245 240"><path fill="currentColor" d="M104.4 103.9c-5.7 0-10.2 5-10.2 11.1s4.6 11.1 10.2 11.1c5.7 0 10.2-5 10.2-11.1.1-6.1-4.5-11.1-10.2-11.1zM140.9 103.9c-5.7 0-10.2 5-10.2 11.1s4.6 11.1 10.2 11.1c5.7 0 10.2-5 10.2-11.1s-4.5-11.1-10.2-11.1z"></path><path fill="currentColor" d="M189.5 20h-134C44.2 20 35 29.2 35 40.6v135.2c0 11.4 9.2 20.6 20.5 20.6h113.4l-5.3-18.5 12.8 11.9 12.1 11.2 21.5 19V40.6c0-11.4-9.2-20.6-20.5-20.6zm-38.6 130.6s-3.6-4.3-6.6-8.1c13.1-3.6 18.1-11.9 18.1-11.9-4.1 2.7-8 4.6-11.5 5.9-5 2.1-9.8 3.5-14.5 4.3-9.6 1.8-18.9 1-27.9-1.2-4.1-.7-8.1-1.4-11.9-2.1-16.5-3.6-22.1-3.6-22.1-3.6s4.6 8.3 17.5 12.1c-3 3.8-6.7 8.3-6.7 8.3-22.1 0-28.5-22.1-28.5-22.1 0-32.6 14.4-58.3 14.4-58.3 14.4-10.8 28.1-10.5 28.1-10.5l1 1.2c-18 5.2-26.3 13.1-26.3 13.1s2.1-1.5 6-3.6c13.1-6.4 23.7-7.4 30.8-7.7 2.1-.1 4.2 0 6.1.1 13.9 1.1 24.6 3.3 35.1 7.4 2.3.9 4.1 1.8 5.7 2.7 0 0-8.3-7.9-26.3-13.1l.9-1.2s13.7-.3 28.1 10.5c0 0 14.4 25.7 14.4 58.3 0 0-6.4 22.1-28.5 22.1z"></path></svg>
                </a>
                <a href="https://github.com/hazreti-ozay" id="github-link" class="social-link" title="GitHub" target="_blank">
                    <svg viewBox="0 0 16 16"><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.01 8.01 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg>
                </a>
            </div>
            <button id="theme-toggle-button" class="btn theme-toggle" title="Temayı Değiştir">
                ☀️
            </button>
        </footer>
    </aside>

    <button id="burger-toggle" class="burger-toggle">☰</button>

    <div id="main-content-wrapper" class="main-content-wrapper">
        <main class="app-content">

            <section id="char-view" class="tab-content active">
                
                <div class="character-card">
                    <h2 class="card-title">Karakter Bilgileri</h2>

                    <div id="campaign-status-display" 
                         style="margin-bottom: 15px; padding: 10px 15px; border-radius: 5px; background-color: var(--color-bg-med); color: var(--color-accent-magic); font-weight: 700;
                                display: none; justify-content: space-between; align-items: center;">
                        <span id="campaign-status-text"></span>
                        <button id="leave-campaign-button" class="btn btn-danger-outline" style="display: none;">Oyundan Ayrıl</button>
                    </div>

                    <div class="form-group">
                        <label for="char-name">İsim:</label>
                        <input type="text" id="char-name" class="char-field">
                    </div>
                    <div class="form-group">
                        <label for="char-desc">Açıklama:</label>
                        <input type="text" id="char-desc" class="char-field" placeholder="Karakterinizin kısa tanımı...">
                    </div>
                    
                    <div class="stats-grid">
                        <div class="form-group">
                            <label for="char-refresh">Refresh:</label>
                            <input type="number" id="char-refresh" class="char-field" value="3">
                        </div>
                        <div class="form-group fate-tracker">
                            <label>Fate Puanı:</label>
                            <div class="fate-point-controls">
                                <button id="minus-fate-point" class="btn btn-danger-outline btn-round" title="Fate Puanı Harca">−</button>
                                <span id="char-fate-points" class="fate-point-display">3</span>
                                <button id="plus-fate-point" class="btn btn-primary-outline btn-round" title="Fate Puanı Kazan">+</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="character-card">
                    <h2 class="card-title">Aspektler (Aspects)</h2>
                    <div class="form-group">
                        <label for="char-high-concept">High Concept:</label>
                        <input type="text" id="char-high-concept" class="char-field" placeholder="Örn: 'Sihir Güçlü Kılıç Ustası'">
                    </div>
                    <div class="form-group">
                        <label for="char-trouble">Trouble:</label>
                        <input type="text" id="char-trouble" class="char-field" placeholder="Örn: 'Altına Olan Zafiyeti'">
                    </div>
                    <div class="form-group">
                        <label for="char-relationship">Relationship:</label>
                        <input type="text" id="char-relationship" class="char-field" placeholder="Örn: 'Eski Ustama Borçluyum'">
                    </div>
                    <div class="form-group">
                        <label for="char-aspect-1">Serbest Aspekt 1:</label>
                        <input type="text" id="char-aspect-1" class="char-field" placeholder="İlk serbest aspektiniz...">
                    </div>
                    <div class="form-group">
                        <label for="char-aspect-2">Serbest Aspekt 2:</label>
                        <input type="text" id="char-aspect-2" class="char-field" placeholder="İkinci serbest aspektiniz...">
                    </div>
                </div>

                <div class="character-card">
                    <h2 class="card-title">Beceriler (Skills)</h2>
                    <div id="skill-list" class="skill-list"></div>
                </div>
                <div class="character-card">
                    <h2 class="card-title">Yetenekler (Stunts)</h2>
                    <div id="stunt-list-ul" class="stunt-list"></div>
                    <div class="stunt-adder-group">
                        <input type="text" id="stunt-input" placeholder="Yeni Stunt açıklaması...">
                        <button id="add-stunt-button" class="btn btn-primary">+</button>
                    </div>
                </div>
                <div class="character-card">
                    <h2 class="card-title">Stres (Stress) & Sonuçlar (Consequences)</h2>
                    <div class="stress-consequences-grid">
                        <div class="stress-column">
                            <h3>Fiziksel Stres</h3>
                            <div id="physical-stress-track" class="stress-track"></div>
                            <h3>Zihinsel Stres</h3>
                            <div id="mental-stress-track" class="stress-track"></div>
                        </div>
                        <div class="consequences-column">
                            <h3>Sonuçlar</h3>
                            <div class="form-group-vertical">
                                <label for="consequence-mild">Hafif (Mild -2):</label>
                                <input type="text" id="consequence-mild" class="char-field">
                            </div>
                            <div class="form-group-vertical">
                                <label for="consequence-moderate">Orta (Moderate -4):</label>
                                <input type="text" id="consequence-moderate" class="char-field">
                            </div>
                            <div class="form-group-vertical">
                                <label for="consequence-severe">Şiddetli (Severe -6):</label>
                                <input type="text" id="consequence-severe" class="char-field">
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="roller-view" class="tab-content roller-grid">
                
                <div class="character-card">
                    <h2 class="card-title">FATE ZAR ATICI</h2>
                    <div class="roller-action-row">
                        <div class="skill-selector-group">
                            <label for="skill-selector">Beceri:</label>
                            <select id="skill-selector"></select>
                        </div>
                        <button id="roll-button" class="btn btn-primary">ZAR AT</button>
                    </div>
                    <div id="dice-container" class="dice-container">
                        <div class="die">?</div>
                        <div class="die">?</div>
                        <div class="die">?</div>
                        <div class="die">?</div>
                    </div>
                    
                    <div class="result-area">
                        <div class="result-detail">
                            <span id="result-dice">Zar: 0</span>
                            <span id="result-skill">Beceri: +0</span>
                        </div>
                        <hr class="result-divider">
                        <div id="result-total" class="result-total">0</div>
                        <div id="result-descriptor" class="result-descriptor">...</div>
                        
                        <button id="spend-fate-point-button" class="btn btn-accent" style="display: none;">
                            Fate Puanı Harca (+2)
                        </button>
                    </div>
                </div>

                <div class="character-card">
                    <h2 class="card-title">Zar Geçmişi</h2>
                    <ul id="roll-log-list" class="roll-log-list">
                        <li class="roll-log-item muted">Henüz zar atılmadı.</li>
                    </ul>
                </div>

                <div id="live-situation-aspects-card" class="character-card" 
                     style="grid-column: 1 / -1; display: none;">
                    <h2 class="card-title">Canlı Durum Aspektleri (GM)</h2>
                    <div id="live-situation-aspect-list" class="stunt-list">
                    </div>
                </div>

            </section>
            
            <section id="find-campaign-view" class="tab-content">
                <div class="character-card">
                    <h2 class="card-title">Genel Kampanyalar</h2>
                    <p class="card-description">
                        Mevcut oyunları arayın ve karakterinizi gönderin. Bir GM iseniz, "Yönet" butonuna basıp şifrenizi girin.
                    </p>
                    <div id="public-campaign-list">
                        <div class="stunt-list-item muted">Genel kampanya bulunamadı veya yükleniyor...</div>
                    </div>
                </div>
            </section>

            <section id="campaign-view" class="tab-content">
                <div class="character-card">
                    <h2 class="card-title">Yeni Kampanya Oluştur (GM)</h2>
                    <p class="card-description">
                        Oyuncuların lobi ekranında göreceği bilgileri doldurun.
                    </p>
                    
                    <div class="form-group">
                        <label for="new-campaign-name">Oyun Adı:</label>
                        <input type="text" id="new-campaign-name" class="char-field" placeholder="Örn: 'Kayıp Kader Kristali'">
                    </div>
                    <div class="form-group">
                        <label for="new-campaign-system">Sistem:</label>
                        <input type="text" id="new-campaign-system" class="char-field" value="FATE">
                    </div>

                    <div class="form-group">
                        <label for="new-campaign-setting">Setting / Dünya:</label>
                        <input type="text" id="new-campaign-setting" class="char-field" placeholder="Örn: 'Ev Yapımı Fantastik, Cyberpunk'">
                    </div>
                    
                    <div class="form-group">
                        <label for="new-campaign-players">Kişi Sayısı:</label>
                        <input type="number" id="new-campaign-players" class="char-field" value="3">
                    </div>

                    <div class="form-group">
                        <label for="new-campaign-desc">Hikaye Kancası:</label>
                        <input type="text" id="new-campaign-desc" class="char-field" placeholder="Oyuncular için kısa bir macera kancası...">
                    </div>

                    <div class="form-group-vertical">
                        <label for="new-campaign-lore" style="font-weight: 700; color: var(--color-text-muted);">
                            Detaylar / Lore (Opsiyonel):
                        </label>
                        <textarea id="new-campaign-lore" class="char-field" rows="5" 
                                  placeholder="Ev kuralları, önemli NPC'ler, dünya bilgisi..."
                                  style="resize: vertical;"></textarea>
                    </div>

                    
                    <div class="menu-divider"></div>
                    
                    <div class="form-group">
                        <label for="new-campaign-password">Yönetim Şifresi:</label>
                        <input type="password" id="new-campaign-password" class="char-field" placeholder="Unutmayacağınız bir şifre girin">
                    </div>
                    
                    <button id="create-campaign-button" class="btn btn-primary" style="width: 100%; margin-top: 10px;">
                        Kampanyayı Lobiye Ekle
                    </button>
                </div>
            </section>
            
            <section id="gm-admin-view" class="tab-content">
                <div class="character-card">
                    <h2 id="gm-admin-title" class="card-title">Kampanya Yönetimi</h2>
                    <p class="card-description">
                        Bu sayfayı sadece kampanya GM'i görebilir.
                    </p>
                </div>

                <div class="character-card">
                    <h2 class="card-title">Firebase Durum Aspektleri</h2>
                    <div id="gm-situation-aspect-list" class="stunt-list">
                    </div>
                    <div class="stunt-adder-group">
                        <input type="text" id="gm-situation-aspect-input" placeholder="Yeni durum aspekti...">
                        <button id="gm-add-situation-aspect-button" class="btn btn-primary">+</button>
                    </div>
                </div>

                <div class="character-card">
                    <h2 class="card-title">Başvuran Karakterler</h2>
                    <div id="gm-submitted-char-list">
                    </div>
                </div>

                <div class="character-card">
                    <h2 class="card-title">Onaylanmış Oyuncular</h2>
                    <div id="gm-approved-players-list">
                    </div>
                </div>
            </section>


            <section id="import-export-view" class="tab-content">
                <div class="character-card">
                    <h2 class="card-title">Karakter Verisi</h2>
                    <p class="card-description">
                        Karakterinizi bir `.json` dosyası olarak kaydedebilir veya daha önce kaydettiğiniz bir dosyayı yükleyebilirsiniz. Bu, karakterinizi paylaşmanın en iyi yoludur.
                    </p>
                    <div class="import-export-buttons">
                        <button id="export-char-button" class="btn btn-primary">Karakteri Dışa Aktar (Export)</button>
                        <input type="file" id="import-file-input" accept=".json" style="display: none;">
                        <button id="import-char-button" class="btn btn-secondary">Karakteri İçe Aktar (Import)</button>
                    </div>
                </div>

                <div class="character-card danger-zone">
                    <h2 class="card-title">Tehlikeli Bölge</h2>
                    <p class="card-description">
                        Bu işlem geri alınamaz. Mevcut karakterinizdeki tüm verileri (aspektler, beceriler, stunt'lar) sıfırlar.
                    </p>
                    <button id="reset-char-button" class="btn btn-danger">Karakteri Sıfırla</button>
                </div>
            </section>

        </main>
    </div> <div id="modal-overlay" class="modal-hidden">
        <div id="modal-container">
            <h2 id="modal-title" class="card-title" style="margin-top: 0; margin-bottom: 15px;"></h2>
            <p id="modal-message"></p>
            
            <div id="modal-input-group" class="form-group-vertical" style="display: none;">
                <input type="text" id="modal-input" class="char-field">
            </div>

            <div class="modal-buttons">
                <button id="modal-cancel-button" class="btn btn-secondary">İptal</button>
                <button id="modal-confirm-button" class="btn btn-primary">Onayla</button>
            </div>
        </div>
    </div>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="app.js"></script>

</body>
</html>